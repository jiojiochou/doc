<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nodejs | 四喜丸子</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="百炼成仙">
    
    <link rel="preload" href="/assets/css/0.styles.89e32c3d.css" as="style"><link rel="preload" href="/assets/js/app.39ac66ed.js" as="script"><link rel="preload" href="/assets/js/3.9570323a.js" as="script"><link rel="preload" href="/assets/js/10.6aed57fa.js" as="script"><link rel="prefetch" href="/assets/js/11.0173eee5.js"><link rel="prefetch" href="/assets/js/12.a51eedbc.js"><link rel="prefetch" href="/assets/js/13.e27978f5.js"><link rel="prefetch" href="/assets/js/4.be8d6596.js"><link rel="prefetch" href="/assets/js/5.03a38802.js"><link rel="prefetch" href="/assets/js/6.18a98952.js"><link rel="prefetch" href="/assets/js/7.077cc29d.js"><link rel="prefetch" href="/assets/js/8.ceb113cb.js"><link rel="prefetch" href="/assets/js/9.52b64985.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4c4a926c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.89e32c3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.jpg" alt="四喜丸子" class="logo"> <span class="site-name can-hide">四喜丸子</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/typescript/Ts.html" class="nav-link">
  typescript
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue3.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/nodejs/secretScript.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/vite/dev.html" class="nav-link">
  vite
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://gitee.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><span class="title">文档</span> <span class="arrow down"></span></button> <button type="button" aria-label="文档" class="mobile-dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/typescript/Ts.html" class="nav-link">
  typescript
</a></li><li class="dropdown-item"><!----> <a href="/vue/vue3.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/nodejs/secretScript.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/vite/dev.html" class="nav-link">
  vite
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://gitee.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>nodejs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/nodejs/secretScript.html#nodejs" class="sidebar-link">nodejs</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/nodejs/secretScript.html#mysql" class="sidebar-link">Mysql</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/nodejs/secretScript.html#业务实例" class="sidebar-link">业务实例</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="nodejs"><a href="#nodejs" class="header-anchor">#</a> nodejs</h2> <h5 id="fs-模块-文件操作系统"><a href="#fs-模块-文件操作系统" class="header-anchor">#</a> fs 模块(文件操作系统):</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//										 文件系统 --------&gt; 都是错误先行</span>
</code></pre></div><h6 id="_1-读文件"><a href="#_1-读文件" class="header-anchor">#</a> 1.<strong>==读文件==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./url'</span><span class="token punctuation">,</span><span class="token string">'utf8'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取文件失败: '</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token comment">//读取到的是 buff格式的 可以 toString()</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_2-写文件"><a href="#_2-写文件" class="header-anchor">#</a> 2.<strong>==写文件==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">wirteFile</span><span class="token punctuation">(</span><span class="token string">'./url'</span><span class="token punctuation">,</span><span class="token string">'内容'</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入失败: '</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_3-删除文件"><a href="#_3-删除文件" class="header-anchor">#</a> 3.<strong>==删除文件==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">'./url'</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除失败'</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_4-改文件名称"><a href="#_4-改文件名称" class="header-anchor">#</a> 4.<strong>==改文件名称==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'./oldUrl'</span><span class="token punctuation">,</span><span class="token string">'./newUrl'</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'修改失败'</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'修改成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_5-查找文件是否存在"><a href="#_5-查找文件是否存在" class="header-anchor">#</a> 5.<strong>==查找文件是否存在==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string">'./url'</span><span class="token punctuation">,</span><span class="token parameter">whether</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>whether<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'有'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'没有'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_6-创建目录"><a href="#_6-创建目录" class="header-anchor">#</a> 6.<strong>==创建目录==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string">'./url'</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'创建目录失败'</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'创建目录成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_7-删除目录"><a href="#_7-删除目录" class="header-anchor">#</a> 7.<strong>==删除目录==</strong>:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">'./url'</span><span class="token punctuation">,</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除目录失败'</span> <span class="token operator">+</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除目录成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="path-模块-路径操作"><a href="#path-模块-路径操作" class="header-anchor">#</a> path 模块(路径操作)</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//	__dirname  代表当前文件所处的目录</span>
</code></pre></div><h6 id="_1-join方法"><a href="#_1-join方法" class="header-anchor">#</a> 1.join方法:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token comment">// 	 只有 ../ 会抵消紧挨着前面的一层路径</span>
<span class="token comment">//	 获得完整的路径</span>
path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'/a'</span><span class="token punctuation">,</span><span class="token string">'/b'</span><span class="token punctuation">,</span><span class="token string">'./c'</span><span class="token punctuation">,</span><span class="token string">'../'</span><span class="token punctuation">,</span><span class="token string">'./d'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_2-在路径中获取文件名"><a href="#_2-在路径中获取文件名" class="header-anchor">#</a> 2.在路径中获取文件名:</h6> <div class="language-js extra-class"><pre class="language-js"><code>path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> pathStr <span class="token operator">=</span> <span class="token string">'/a/b/c/d/e/index.html'</span>
<span class="token keyword">let</span> fileName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>pathStr<span class="token punctuation">)</span> <span class="token comment">//index.html</span>
<span class="token comment">//不要拓展名</span>
<span class="token keyword">let</span> fileName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>pathStr<span class="token punctuation">,</span><span class="token string">'.html'</span><span class="token punctuation">)</span> <span class="token comment">// index</span>
</code></pre></div><h6 id="_3-获取文件扩展名"><a href="#_3-获取文件扩展名" class="header-anchor">#</a> 3.获取文件扩展名:</h6> <div class="language-js extra-class"><pre class="language-js"><code>path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> fileName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>pathStr<span class="token punctuation">)</span> <span class="token comment">// .html</span>
</code></pre></div><h5 id="querystring-模块"><a href="#querystring-模块" class="header-anchor">#</a> querystring 模块</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 专门处理查询字符串</span>
</code></pre></div><h6 id="_1-把查询字符串解析为对象"><a href="#_1-把查询字符串解析为对象" class="header-anchor">#</a> 1.把查询字符串解析为对象:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> qs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token comment">// {name: zs, age: 18, sex: 男}</span>
</code></pre></div><h5 id="http-模块-web服务"><a href="#http-模块-web服务" class="header-anchor">#</a> http 模块(web服务)</h5> <h6 id="_1-创建基本的服务器"><a href="#_1-创建基本的服务器" class="header-anchor">#</a> 1.创建基本的服务器:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token comment">// 创建实例服务</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 监听客户端的 请求事件 </span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>url <span class="token comment">// 客户端请求的 路径 默认 '/' (/index,/user.....)</span>
    req<span class="token punctuation">.</span>method <span class="token comment">// 客户端请求的方法 &quot;GET&quot; or &quot;POST&quot;</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 客户端的数据</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//客户端数据发送完毕</span>
    
    res<span class="token punctuation">.</span><span class="token function">setHead</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span><span class="token string">'text/html; charset=utf-8'</span><span class="token punctuation">)</span> <span class="token comment">//防止中文乱码</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 相应给客户端的方法 </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//绑定端口号</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server runnig at http://127.0.0.1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="模块化"><a href="#模块化" class="header-anchor">#</a> 模块化</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// require 引入</span>
<span class="token comment">// exports 暴露</span>
<span class="token comment">// module.exports 暴露</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// exports 和 module.exports 指向的是同一个对象</span>
<span class="token comment">// 但永远暴露的是 module.exports 所指定的对象</span>
</code></pre></div><h5 id="模块的加载机制"><a href="#模块的加载机制" class="header-anchor">#</a> 模块的加载机制</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span><span class="token function">查找指定文件</span> <span class="token punctuation">(</span>指定什么文件<span class="token punctuation">,</span>就查找什么文件<span class="token punctuation">)</span>
<span class="token number">2.</span>如果找不到会在文件后面 依次拼接上后缀 <span class="token function">分别为</span> <span class="token punctuation">(</span><span class="token punctuation">.</span>js<span class="token operator">/</span><span class="token punctuation">.</span>json<span class="token operator">/</span><span class="token punctuation">.</span>node<span class="token punctuation">)</span>的文件<span class="token punctuation">,</span>如果是目录会查看 有没有 <span class="token keyword">package</span><span class="token punctuation">.</span>json 文件里面有没有<span class="token string">&quot;main&quot;</span>属性所指定要加载的文件<span class="token punctuation">,</span>没有默认加载 <span class="token string">'index.js'</span>

<span class="token number">3.</span>不指定 <span class="token punctuation">.</span><span class="token operator">/</span> 或者 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span> 这样的路径 node会认为是内置模块 或者 第三方模块 内置模块和第三方模块名字一样<span class="token punctuation">,</span>优先加载内置模块<span class="token punctuation">.</span>加载第三方模块的时候<span class="token punctuation">,</span>会在当前引入的文件的父级找文件名为 node_modules 的文件夹里面去找所指定的模块<span class="token punctuation">,</span>找到指定模块后找 <span class="token keyword">package</span><span class="token punctuation">.</span>json 里面的<span class="token string">&quot;main&quot;</span>所指定的文件名进行加载<span class="token punctuation">,</span>没有默认加载 <span class="token string">'index.js'</span><span class="token punctuation">,</span>如果找不到会一层层向上查找直到根目录报错为止
<span class="token number">4.</span>多次引入同一个模块<span class="token punctuation">,</span>会运行第一次引入的是否<span class="token punctuation">,</span> 因为有缓存
</code></pre></div><h5 id="express-第三方模块-web构建"><a href="#express-第三方模块-web构建" class="header-anchor">#</a> express 第三方模块(web构建)</h5> <h6 id="_1-get请求和post请求"><a href="#_1-get请求和post请求" class="header-anchor">#</a> 1.get请求和post请求:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>query
    req<span class="token punctuation">.</span>parmes
    req<span class="token punctuation">.</span>body
    
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'express server running at http://127.0.0.1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_2-静态资源访问"><a href="#_2-静态资源访问" class="header-anchor">#</a> 2.静态资源访问</h6> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//指定静态资源文件夹</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">,</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 访问时必须加上 /public 前缀才能访问 静态资源</span>
</code></pre></div><h6 id="_3-中间件"><a href="#_3-中间件" class="header-anchor">#</a> 3.中间件</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//给函数添加 next 就成为了 中间件</span>
<span class="token comment">// 请求 / 的时候 触发的中间件</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'zs'</span>
    <span class="token comment">//放行操作,不调用它程序不会往下执行</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 上游中间件的 req,res 下游的中间件和路由 是共享的</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// zs</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_4-app-use-中间件"><a href="#_4-app-use-中间件" class="header-anchor">#</a> 4.app.use() 中间件</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//全局中间件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_4-1错误处理中间件"><a href="#_4-1错误处理中间件" class="header-anchor">#</a> 4.1错误处理中间件</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//定义在后面的中间件,用于捕捉错误,防止因为错误造成页面崩溃</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'服务器发生错误'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_5-解决跨域问题"><a href="#_5-解决跨域问题" class="header-anchor">#</a> 5.解决跨域问题</h6> <div class="language-js extra-class"><pre class="language-js"><code>npm i cors
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span>
<span class="token comment">//	在路由之前调用</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_5-urlcoded"><a href="#_5-urlcoded" class="header-anchor">#</a> 5.urlcoded</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//用于解析 请求体 urlcoded格式的中间件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlcoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">exxxxx</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_6-项目与mysql建立关联-操作数据库"><a href="#_6-项目与mysql建立关联-操作数据库" class="header-anchor">#</a> 6.项目与mysql建立关联,操作数据库:</h6> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// n</span>
<span class="token keyword">const</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mysql'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> db <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>		<span class="token comment">//数据库的IP 地址</span>
    <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>			<span class="token comment">//登录数据库的账号</span>
    <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span>		<span class="token comment">//登录数据库的密码</span>
    <span class="token literal-property property">database</span><span class="token operator">:</span> <span class="token string">'my_db'</span>		<span class="token comment">//指定要操作那个数据库</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h6 id="_7-select语句查找数据库数据"><a href="#_7-select语句查找数据库数据" class="header-anchor">#</a> 7.select语句查找数据库数据:</h6> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'select * from users'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>rlt</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rlt<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="mysql"><a href="#mysql" class="header-anchor">#</a> Mysql</h2> <h5 id="_1-datatype-数据类型"><a href="#_1-datatype-数据类型" class="header-anchor">#</a> 1.DataType 数据类型:</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> int 整形
<span class="token number">2.</span> <span class="token function">varchar</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span> 字符串
<span class="token number">3.</span> <span class="token function">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 布尔值
</code></pre></div><h5 id="_2-字段的特殊标识"><a href="#_2-字段的特殊标识" class="header-anchor">#</a> 2.字段的特殊标识:</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> <span class="token constant">PK</span> <span class="token punctuation">(</span>Primary Key<span class="token punctuation">)</span> 主键<span class="token punctuation">.</span>唯一标识
<span class="token number">2.</span> <span class="token constant">NN</span> <span class="token punctuation">(</span>Not Null<span class="token punctuation">)</span> 值不允许为空
<span class="token number">3.</span> <span class="token constant">UQ</span> <span class="token punctuation">(</span>Unique<span class="token punctuation">)</span> 值唯一
<span class="token number">4.</span> <span class="token constant">AI</span> <span class="token punctuation">(</span>Auto Increment<span class="token punctuation">)</span> 值自动增长
</code></pre></div><h2 id="业务实例"><a href="#业务实例" class="header-anchor">#</a> 业务实例</h2> <h5 id="_1-web开发模式"><a href="#_1-web开发模式" class="header-anchor">#</a> 1.web开发模式:</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> 服务端直接渲染页面
<span class="token number">2.</span> 前后端分离
<span class="token number">3.</span> 两者混合
</code></pre></div><h5 id="_2-身份认证的概念"><a href="#_2-身份认证的概念" class="header-anchor">#</a> 2.身份认证的概念:</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 又称 身份认证,身份鉴权, 通过一定手段对用户身份的确认</span>

<span class="token comment">// 确认当前所声称为某种身份的用户, 确实是所声称的用户</span>

<span class="token comment">// 服务端渲染 推荐使用 session 认证机制</span>

<span class="token comment">// 前后端分离 推荐使用 JWT认证机制</span>
</code></pre></div><h5 id="_3-cookie"><a href="#_3-cookie" class="header-anchor">#</a> 3.cookie:</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> 存储在用户的浏览器中的一段不超过 4KB 的字符串<span class="token punctuation">,</span> 它是由一个 key value组成

<span class="token comment">// Cookie 的特点</span>
<span class="token punctuation">.</span> 不同域名下的 Cookie 各自独立 <span class="token comment">// 域名独立</span>
<span class="token punctuation">.</span> 每当客户端发起请求的时候<span class="token punctuation">,</span> 会自动把当前域名下所有未过期的 Cookie 一同发送到服务器 <span class="token comment">// 自动发送,前提未过期的所用的</span>
<span class="token punctuation">.</span> 有过期时限
<span class="token punctuation">.</span> <span class="token number">4</span> <span class="token constant">KB</span>


<span class="token comment">// 客户端第一次请求的时候,服务端 通过响应头的形式, 向客户端发送一个身份认证的 Cookie,客户端会自动将 Cookie 保存在浏览器中</span>
<span class="token comment">//客户端每次请求的时候,会自动将身份认证相关的 Cookie ,通过请求头的形式发送给服务端,服务端进行验证</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.39ac66ed.js" defer></script><script src="/assets/js/3.9570323a.js" defer></script><script src="/assets/js/10.6aed57fa.js" defer></script>
  </body>
</html>
